__iWAM={sessionTime:5,init:function(){navigator.standalone||("complete"==document.readyState||"loaded"==document.readyState||"interactive"==document.readyState?__iWAM.fetch():document.addEventListener("DOMContentLoaded",this.init))},parse:function(e){if(("standalone"==e.display||"fullscreen"==e.display)&&(this.addHeader("meta","apple-mobile-web-app-capable","yes"),this.addHeader("meta","apple-mobile-web-app-status-bar-style","fullscreen"==e.display?"black-translucent":"black")),e.name||e.short_name){var a=e.name.length<13?e.name:e.short_name?e.short_name:e.name;this.addHeader("meta","apple-mobile-web-app-title",a)}e.icons&&Array.isArray(e.icons)&&this.parseIcons(e.icons),e.start_url&&this.parseStartURL(e),e.orientation&&"any"!=e.orientation,e.related_applications&&Array.isArray(e.related_applications)&&e.related_applications.forEach(function(e){"itunes"==e.platform&&__iWAM.addHeader("meta","apple-itunes-app","app-id="+e.id+"; app-argument="+location.href)}),e.background_color},parseStartURL:function(e){var a=new URL(e.start_url,document.URL),t=new URL(document.URL),n="";return a.host!=t.host?void console.error("Ignoring start_url: it should be on the same host as this page"):(a.pathname!=t.pathname&&(n=a.pathname+a.hash),n+=a.search,void(n.length>1&&""==location.hash&&(location.hash="#_s_u="+encodeURIComponent(n))))},parseIcons:function(e){var a=[];e.forEach(function(e,t){if(void 0==e.type||"image/png"==e.type){var n="96";try{n=e.sizes.substring(0,e.sizes.indexOf("x"))}catch(i){}a.push({href:e.src,size:n})}});var t="iPhone"==navigator.platform||"iPod"==navigator.platform?3==devicePixelRatio?180:120:"iPad"==navigator.platform?1==devicePixelRatio?76:matchMedia("device-width: 1024px").matches?167:152:96,n={distance:1e3,icon:null};a.forEach(function(e){e.size>t&&e.size-t<n.distance&&(n.distance=e.size-t,n.icon=e)}),null==n.icon&&(n.distance=1e3,a.forEach(function(e){t-e.size<n.distance&&(n.distance=t-e.size,n.icon=e)})),this.addHeader("link","apple-touch-icon-precomposed",n.icon.href)},fetch:function(){if("iPhone"==navigator.platform||"iPad"==navigator.platform){var e=document.querySelector("link[rel=manifest]");if(e){var a=e.href,t=new XMLHttpRequest;t.open("GET",a),t.responseType="json",t.addEventListener("load",function(){__iWAM.parse(t.response)}),t.addEventListener("error",function(){console.error("Manifest download error")}),t.send()}}},addHeader:function(e,a,t){var n=document.getElementsByTagName("head")[0],i=document.createElement(e),o=!1;"meta"==e?(i.name=a,i.content=t,o=void 0!=document.querySelector("meta[name="+a+"]")):"link"==e&&(i.rel=a,i.href=t,o=void 0!=document.querySelector("link[rel="+a+"]")),o||n.appendChild(i)}},__iWAM.init();